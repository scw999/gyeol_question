<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê²°í•˜ë‹¤ ì£¼ê´€ì  ì„ í˜¸ ì„¤ë¬¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .question-card {
            transition: all 0.3s ease-in-out;
        }
        .result-bar {
            transition: width 1s ease-in-out;
        }
        .expectation-q {
            border-left: 4px solid #14b8a6; /* teal-500 */
            background-color: #f0fdfa; /* teal-50 */
        }
        .self-q {
             border-left: 4px solid #6366f1; /* indigo-500 */
            background-color: #eef2ff; /* indigo-50 */
        }
        /* Custom styles for range input */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            margin: 7.3px 0;
            background: transparent;
        }
        input[type=range]:focus {
            outline: none;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 11.4px;
            cursor: pointer;
            background: #e2e8f0;
            border-radius: 5px;
        }
        input[type=range]::-webkit-slider-thumb {
            height: 26px;
            width: 26px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
            -webkit-appearance: none;
            margin-top: -7.3px;
        }
        input[type=range]:focus::-webkit-slider-runnable-track {
            background: #d1d5db;
        }
        input[type=range]::-moz-range-track {
            width: 100%;
            height: 11.4px;
            cursor: pointer;
            background: #e2e8f0;
            border-radius: 5px;
        }
        input[type=range]::-moz-range-thumb {
            height: 26px;
            width: 26px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <!-- Header -->
        <header class="text-center mb-8 md:mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-indigo-600">ê²°í•˜ë‹¤</h1>
            <p class="text-lg md:text-xl text-gray-600 mt-2">ì£¼ê´€ì  ì„ í˜¸ ì„¤ë¬¸ (v9: ìµœì¢… í†µí•©ë³¸)</p>
        </header>

        <!-- Input Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Male Form -->
            <div class="bg-blue-50 p-6 rounded-2xl shadow-md border border-blue-200">
                <h2 class="text-2xl font-bold text-center mb-6 text-blue-800">ğŸ‘¨â€ğŸ¦± ë‚¨ì„±</h2>
                <form id="male-form" class="space-y-8">
                    <!-- Questions will be dynamically inserted here -->
                </form>
            </div>

            <!-- Female Form -->
            <div class="bg-pink-50 p-6 rounded-2xl shadow-md border border-pink-200">
                <h2 class="text-2xl font-bold text-center mb-6 text-pink-800">ğŸ‘©â€ğŸ¦° ì—¬ì„±</h2>
                <form id="female-form" class="space-y-8">
                    <!-- Questions will be dynamically inserted here -->
                </form>
            </div>
        </div>

        <!-- Action Button -->
        <div class="text-center mt-8 md:mt-12">
            <button id="view-result-btn" class="bg-indigo-600 text-white font-bold py-4 px-8 rounded-full text-xl hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 transition-transform transform hover:scale-105">
                ê¶í•© ê²°ê³¼ ë³´ê¸°
            </button>
        </div>

        <!-- Result Modal -->
        <div id="result-modal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center p-4 z-50">
            <div id="result-content" class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto p-6 md:p-8 relative transform scale-95 transition-transform duration-300">
                <button id="close-modal-btn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
                
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-indigo-600">ê´€ê³„ ê¶í•© ë¦¬í¬íŠ¸</h2>
                </div>

                <!-- Overall Score -->
                <div class="bg-indigo-50 border-2 border-indigo-200 rounded-xl p-6 text-center mb-8">
                    <p class="text-lg text-indigo-800 mb-2">ë‘ ë¶„ì˜ ì¢…í•© ê¶í•© ì§€ìˆ˜ëŠ”?</p>
                    <p id="overall-score" class="text-7xl font-extrabold text-indigo-600">0ì </p>
                    <p id="overall-comment" class="mt-3 text-base text-indigo-700 font-medium"></p>
                </div>

                <!-- Detailed Scores -->
                <div class="space-y-6" id="detailed-results-container">
                    <!-- Detailed results will be inserted here -->
                </div>

                <!-- Ice Breaking Questions -->
                 <div class="mt-10 pt-6 border-t-2 border-gray-200">
                    <h3 class="text-2xl font-bold text-center text-gray-800 mb-6">ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”! ğŸ’¬</h3>
                    <div id="ice-breaking-questions" class="space-y-5">
                        <!-- Ice breakers will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            // Part 1: ê°€ì¹˜ê´€
            { id: 'q1_self', part: "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)", q_type: 'self', text: "1ì–µ ì›ì˜ ë³´ë„ˆìŠ¤ê°€ ìƒê²¼ìŠµë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì„ íƒì€?", type: "select", options: [{ value: "a", text: "ì¦‰ì‹œ í‰ì†Œ ê¿ˆê¾¸ë˜ ì°¨ë¥¼ ê³„ì•½í•œë‹¤ (í˜„ì¬ì˜ ë§Œì¡±)" }, { value: "b", text: "ì•ˆì •ì ì¸ ìš°ëŸ‰ì£¼ì— ì¥ê¸° íˆ¬ìí•œë‹¤ (ë¯¸ë˜ì˜ ì•ˆì •)" }, { value: "c", text: "ë¶€ëª¨ë‹˜ê»˜ ì ˆë°˜ì„ ë“œë¦¬ê³  ë‚˜ë¨¸ì§€ëŠ” ì €ì¶•í•œë‹¤ (ê°€ì¡±ê³¼ ê´€ê³„)" }, { value: "d", text: "MBA ì§„í•™ ë“± ì»¤ë¦¬ì–´ ë°œì „ì„ ìœ„í•´ ì‚¬ìš©í•œë‹¤ (ì„±ì¥ê³¼ ì„±ì·¨)" }] },
            { id: 'q1_exp', part: "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)", q_type: 'expectation', text: "íŒŒíŠ¸ë„ˆê°€ 1ì–µ ë³´ë„ˆìŠ¤ë¥¼ ë°›ì•˜ì„ ë•Œ, ì–´ë–»ê²Œ ì‚¬ìš©í•˜ê¸¸ ë°”ë¼ë‚˜ìš”?", type: "select", options: [{ value: "a", text: "ì¦‰ì‹œ í‰ì†Œ ê¿ˆê¾¸ë˜ ì°¨ë¥¼ ê³„ì•½í•œë‹¤ (í˜„ì¬ì˜ ë§Œì¡±)" }, { value: "b", text: "ì•ˆì •ì ì¸ ìš°ëŸ‰ì£¼ì— ì¥ê¸° íˆ¬ìí•œë‹¤ (ë¯¸ë˜ì˜ ì•ˆì •)" }, { value: "c", text: "ë¶€ëª¨ë‹˜ê»˜ ì ˆë°˜ì„ ë“œë¦¬ê³  ë‚˜ë¨¸ì§€ëŠ” ì €ì¶•í•œë‹¤ (ê°€ì¡±ê³¼ ê´€ê³„)" }, { value: "d", text: "MBA ì§„í•™ ë“± ì»¤ë¦¬ì–´ ë°œì „ì„ ìœ„í•´ ì‚¬ìš©í•œë‹¤ (ì„±ì¥ê³¼ ì„±ì·¨)" }] },
            { id: 'q_child_plan_self', part: "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)", q_type: 'self', text: "ìë…€ ê³„íšì— ëŒ€í•œ ë‹¹ì‹ ì˜ ìƒê°ì€ ì–´ë–¤ê°€ìš”?", type: "select", options: [{ value: "a", text: "ê¼­ ë‚³ê³  ì‹¶ë‹¤ (ìë…€ëŠ” ì‚¶ì˜ ê¸°ì¨)" }, { value: "b", text: "ìƒëŒ€ë°©ê³¼ í•©ì˜ëœë‹¤ë©´ ë‚³ê³  ì‹¶ë‹¤ (ê´€ê³„ ì¤‘ì‹¬)" }, { value: "c", text: "ë”©í¬(DINK)ë¥¼ ì„ í˜¸í•œë‹¤ (ê°œì¸ì˜ ì‚¶ ì¤‘ì‹œ)" }, { value: "d", text: "ì•„ì§ ì˜ ëª¨ë¥´ê² ë‹¤ (ë¯¸ì •)"}] },
            { id: 'q_m1_self', part: "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)", for_gender: 'male', q_type: 'self', text: "ì—°ì¸ì´ ë‹¹ì‹ ì˜ ì†Œë“ì´ë‚˜ ì§ì—… ì•ˆì •ì„±ì— ëŒ€í•´ ë¶ˆì•ˆê°ì„ ë‚´ë¹„ì¹œë‹¤ë©´, ë‹¹ì‹ ì˜ ë°˜ì‘ì€?", type: "select", options: [{ value: "a", text: "ë¶ˆì•ˆí•¨ì„ ê³µê°í•˜ë©°, í•¨ê»˜ ë¯¸ë˜ ê³„íšì„ ì„¸ìš´ë‹¤" }, { value: "b", text: "ë‚´ ëŠ¥ë ¥ì„ ë¯¿ì–´ì£¼ì§€ ì•ŠëŠ” ê²ƒ ê°™ì•„ ì„œìš´í•˜ë‹¤" }, { value: "c", text: "ë” ì•ˆì •ì ì¸ ì§ì¥ì„ ì•Œì•„ë´ì•¼ í•˜ë‚˜ ê³ ë¯¼í•œë‹¤" }] },
            { id: 'q_m1_exp', part: "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)", for_gender: 'female', q_type: 'expectation', text: "íŒŒíŠ¸ë„ˆê°€ ê·¸ì˜ ì†Œë“/ì§ì—…ì— ëŒ€í•œ ë‹¹ì‹ ì˜ ë¶ˆì•ˆê°ì— ì–´ë–»ê²Œ ë°˜ì‘í•´ì£¼ê¸¸ ë°”ë¼ë‚˜ìš”?", type: "select", options: [{ value: "a", text: "ë¶ˆì•ˆí•¨ì„ ê³µê°í•˜ë©°, í•¨ê»˜ ë¯¸ë˜ ê³„íšì„ ì„¸ìš´ë‹¤" }, { value: "b", text: "ë‚´ ëŠ¥ë ¥ì„ ë¯¿ì–´ì£¼ì§€ ì•ŠëŠ” ê²ƒ ê°™ì•„ ì„œìš´í•˜ë‹¤" }, { value: "c", text: "ë” ì•ˆì •ì ì¸ ì§ì¥ì„ ì•Œì•„ë´ì•¼ í•˜ë‚˜ ê³ ë¯¼í•œë‹¤" }] },
            { id: 'q_f1_self', part: "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)", for_gender: 'female', q_type: 'self', text: "ê²°í˜¼/ì¶œì‚°ìœ¼ë¡œ ì»¤ë¦¬ì–´ê°€ ì¤‘ë‹¨ë  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì— ëŒ€í•´ ì–´ë–»ê²Œ ìƒê°í•˜ì‹œë‚˜ìš”?", type: "select", options: [{ value: "a", text: "ì»¤ë¦¬ì–´ë³´ë‹¤ ê°€ì •ì´ ì¤‘ìš”í•˜ë¯€ë¡œ, ê°ìˆ˜í•  ìˆ˜ ìˆë‹¤" }, { value: "b", text: "ê²½ë ¥ ë‹¨ì ˆì€ ì•ˆëœë‹¤. íŒŒíŠ¸ë„ˆì™€ í•¨ê»˜ í•´ê²°ì±…ì„ ì°¾ì„ ê²ƒì´ë‹¤" }, { value: "c", text: "ì»¤ë¦¬ì–´ë¥¼ ìœ„í•´ ê²°í˜¼/ì¶œì‚°ì„ ë¯¸ë£¨ê±°ë‚˜ í¬ê¸°í•  ìˆ˜ ìˆë‹¤" }] },
            { id: 'q_f1_exp', part: "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)", for_gender: 'male', q_type: 'expectation', text: "íŒŒíŠ¸ë„ˆê°€ ê²°í˜¼/ì¶œì‚°ìœ¼ë¡œ ì¸í•œ ì»¤ë¦¬ì–´ ì¤‘ë‹¨ ê°€ëŠ¥ì„±ì— ëŒ€í•´ ì–´ë–»ê²Œ ìƒê°í•˜ê¸¸ ë°”ë¼ë‚˜ìš”?", type: "select", options: [{ value: "a", text: "ì»¤ë¦¬ì–´ë³´ë‹¤ ê°€ì •ì´ ì¤‘ìš”í•˜ë¯€ë¡œ, ê°ìˆ˜í•  ìˆ˜ ìˆë‹¤" }, { value: "b", text: "ê²½ë ¥ ë‹¨ì ˆì€ ì•ˆëœë‹¤. íŒŒíŠ¸ë„ˆì™€ í•¨ê»˜ í•´ê²°ì±…ì„ ì°¾ì„ ê²ƒì´ë‹¤" }, { value: "c", text: "ì»¤ë¦¬ì–´ë¥¼ ìœ„í•´ ê²°í˜¼/ì¶œì‚°ì„ ë¯¸ë£¨ê±°ë‚˜ í¬ê¸°í•  ìˆ˜ ìˆë‹¤" }] },
            
            // Part 2: ì„±ê²©/ê¸°ì§ˆ
            { id: 'q5_self', part: "Part 2: íƒ€ê³ ë‚œ ë‹¤ë¦„ (ì„±ê²©/ê¸°ì§ˆ)", q_type: 'self', text: "ì—°ì¸ê³¼ ê°ˆë“±ì´ ìƒê²¼ì„ ë•Œ, ë‹¹ì‹ ì˜ ì¼ë°˜ì ì¸ ë°˜ì‘ì€?", type: "select", options: [{ value: "a", text: "ê°ì •ì´ ê²©í•´ì§€ë”ë¼ë„ ê·¸ ìë¦¬ì—ì„œ ë°”ë¡œ ëŒ€í™”ë¡œ í’€ì–´ì•¼ í•œë‹¤ (ì¦‰ì‹œ í•´ê²°í˜•)" }, { value: "b", text: "ì¼ë‹¨ ê°ì ìƒê°í•  ì‹œê°„ì„ ê°–ê³ , ê°ì •ì´ ê°€ë¼ì•‰ìœ¼ë©´ ëŒ€í™”í•œë‹¤ (ìˆ™ê³  í›„ í•´ê²°í˜•)" }, { value: "c", "text": "ìƒëŒ€ë°©ì˜ ê¸°ë¶„ì´ í’€ë¦´ ë•Œê¹Œì§€ ì¼ë‹¨ ë§ì¶°ì£¼ê³ , ë‚˜ì¤‘ì— ë‹¤ì‹œ ì´ì•¼ê¸°í•œë‹¤ (í™”í•© ìš°ì„ í˜•)" }, { value: "d", text: "ë¬¸ì œë¥¼ ì§ì ‘ì ìœ¼ë¡œ ì–¸ê¸‰í•˜ê¸°ë³´ë‹¤, ì‹œê°„ì´ í•´ê²°í•´ì£¼ê¸¸ ê¸°ë‹¤ë¦°ë‹¤ (íšŒí”¼í˜•)" }] },
            { id: 'q5_exp', part: "Part 2: íƒ€ê³ ë‚œ ë‹¤ë¦„ (ì„±ê²©/ê¸°ì§ˆ)", q_type: 'expectation', text: "ì—°ì¸ì´ ê°ˆë“± ìƒí™©ì—ì„œ ì–´ë–»ê²Œ ë°˜ì‘í•´ì£¼ê¸¸ ë°”ë¼ë‚˜ìš”?", type: "select", options: [{ value: "a", text: "ê°ì •ì´ ê²©í•´ì§€ë”ë¼ë„ ê·¸ ìë¦¬ì—ì„œ ë°”ë¡œ ëŒ€í™”ë¡œ í’€ì–´ì•¼ í•œë‹¤ (ì¦‰ì‹œ í•´ê²°í˜•)" }, { value: "b", text: "ì¼ë‹¨ ê°ì ìƒê°í•  ì‹œê°„ì„ ê°–ê³ , ê°ì •ì´ ê°€ë¼ì•‰ìœ¼ë©´ ëŒ€í™”í•œë‹¤ (ìˆ™ê³  í›„ í•´ê²°í˜•)" }, { value: "c", "text": "ìƒëŒ€ë°©ì˜ ê¸°ë¶„ì´ í’€ë¦´ ë•Œê¹Œì§€ ì¼ë‹¨ ë§ì¶°ì£¼ê³ , ë‚˜ì¤‘ì— ë‹¤ì‹œ ì´ì•¼ê¸°í•œë‹¤ (í™”í•© ìš°ì„ í˜•)" }, { value: "d", text: "ë¬¸ì œë¥¼ ì§ì ‘ì ìœ¼ë¡œ ì–¸ê¸‰í•˜ê¸°ë³´ë‹¤, ì‹œê°„ì´ í•´ê²°í•´ì£¼ê¸¸ ê¸°ë‹¤ë¦°ë‹¤ (íšŒí”¼í˜•)" }] },
            
            // Part 3: ë¼ì´í”„ìŠ¤íƒ€ì¼
            { id: 'q7_self', part: "Part 3: ì¼ìƒì˜ í•© (ë¼ì´í”„ìŠ¤íƒ€ì¼)", q_type: 'self', text: "ê¿ˆì— ê·¸ë¦¬ë˜ ì™„ë²½í•œ í† ìš”ì¼, ë‹¹ì‹ ì˜ í•˜ë£¨ëŠ” ì–´ë–¤ ëª¨ìŠµì— ê°€ì¥ ê°€ê¹Œìš´ê°€ìš”?", type: "select", options: [{ value: "a", text: "í•˜ë£¨ ì¢…ì¼ ì¹¨ëŒ€ì™€ í•œ ëª¸! ë„·í”Œë¦­ìŠ¤ì™€ ë°°ë‹¬ ìŒì‹ê³¼ í•¨ê»˜í•˜ëŠ” ì™„ì „í•œ ë°©ì½• (ì™„ì „í•œ íœ´ì‹)" }, { value: "b", text: "ì•„ì¹¨ ì¼ì° ë“±ì‚° í›„, ë§›ìˆëŠ” ë§‰ê±¸ë¦¬ì™€ íŒŒì „ìœ¼ë¡œ ë§ˆë¬´ë¦¬ (ì•„ì›ƒë„ì–´/í™œë™)" }, { value: "c", text: "ë¯¸ìˆ ê´€ì—ì„œ ì˜ê°ì„ ì–»ê³ , ì €ë…ì—” ë¶„ìœ„ê¸° ì¢‹ì€ ì¬ì¦ˆë°”ì—ì„œ ì¹µí…Œì¼ í•œ ì” (ë¬¸í™”/ì˜ˆìˆ )" }, { value: "d", text: "ì¹œêµ¬ë“¤ê³¼ ë§Œë‚˜ ë¸ŒëŸ°ì¹˜ë¥¼ ì¦ê¸°ê³ , ì €ë…ì—” ìƒˆë¡œìš´ ì‚¬ëŒë“¤ê³¼ ì–´ìš¸ë¦¬ëŠ” íŒŒí‹° ì°¸ì„ (ì‚¬êµ/ë„¤íŠ¸ì›Œí‚¹)" }, { value: "e", text: "ëŒ€ì²­ì†Œë¡œ ì§‘ì„ ë°˜ì§ì´ê²Œ ë§Œë“¤ê³ , ì •ì„±ê» ìš”ë¦¬í•´ì„œ ì†Œì¤‘í•œ ì‚¬ëŒê³¼ ì €ë… ì‹ì‚¬ (ìê¸°ê´€ë¦¬/ì•ˆì •)" }, { value: "f", text: "ë•€ í˜ë¦¬ëŠ” ìš´ë™(í—¬ìŠ¤, í•„ë¼í…ŒìŠ¤) í›„ ë§ˆì‹œëŠ” ì‹œì›í•œ ë‹¨ë°±ì§ˆ ì‰ì´í¬ (ìŠ¤í¬ì¸ /ê±´ê°•)" }, { value: "g", text: "ì¹œêµ¬ë“¤ê³¼ ëª¨ì—¬ ë³´ë“œê²Œì„ì„ í•˜ë©° ë°¤ìƒˆ ì›ƒê³  ë– ë“¤ê¸° (ì‹¤ë‚´/ì‚¬êµ)" }, { value: "h", text: "í‰ì†Œ ë°°ìš°ê³  ì‹¶ì—ˆë˜ ë² ì´í‚¹ ë“± ì›ë°ì´ í´ë˜ìŠ¤ ì°¸ì—¬í•˜ê¸° (ìê¸°ê³„ë°œ/ì·¨ë¯¸)" }, { value: "i", text: "ë°˜ë ¤ë™ë¬¼ê³¼ í•¨ê»˜ ì• ê²¬ ì¹´í˜ë‚˜ ë„“ì€ ê³µì›ì—ì„œ ì‹œê°„ ë³´ë‚´ê¸° (ë°˜ë ¤ë™ë¬¼/êµê°)" }] },
            { id: 'q_dessert_self', part: "Part 3: ì¼ìƒì˜ í•© (ë¼ì´í”„ìŠ¤íƒ€ì¼)", q_type: 'self', text: "ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ë””ì €íŠ¸ ìŠ¤íƒ€ì¼ì€ ë¬´ì—‡ì¸ê°€ìš”?", type: "select", options: [{ value: "a", text: "ì¼€ì´í¬, ë§ˆì¹´ë¡± ë“± ë‹¬ì½¤í•œ ì„œì–‘ì‹ ë””ì €íŠ¸" }, { value: "b", text: "ë¹™ìˆ˜, ì•„ì´ìŠ¤í¬ë¦¼ ë“± ì‹œì›í•œ ë””ì €íŠ¸" }, { value: "c", text: "ì•½ê³¼, ë–¡, íŒ¥ë¹™ìˆ˜ ë“± K-ë””ì €íŠ¸" }, { value: "d", text: "ë””ì €íŠ¸ëŠ” ë³„ë¡œ... (í•´ë‹¹ ì—†ìŒ)" }] },
            { id: 'q_m2_self', part: "Part 3: ì¼ìƒì˜ í•© (ë¼ì´í”„ìŠ¤íƒ€ì¼)", for_gender: 'male', q_type: 'self', text: "ê°œì¸ ì·¨ë¯¸(ê²Œì„, ë‚šì‹œ ë“±)ì— ì£¼ë§ ì‹œê°„ì„ ì˜¨ì „íˆ ì‚¬ìš©í•˜ëŠ” ê²ƒì— ëŒ€í•´ ì—°ì¸ì´ ì„œìš´í•´í•œë‹¤ë©´?", type: "select", options: [{ value: "a", text: "ì—°ì¸ê³¼ì˜ ì‹œê°„ì´ ë” ì¤‘ìš”í•˜ë¯€ë¡œ, ì·¨ë¯¸ë¥¼ ì¤„ì¸ë‹¤" }, { value: "b", text: "ì„œìš´í•¨ì„ í’€ì–´ì£¼ê³ , ì·¨ë¯¸ì˜ ì¤‘ìš”ì„±ì„ ì„¤ëª…í•˜ë©° íƒ€í˜‘ì ì„ ì°¾ëŠ”ë‹¤" }, { value: "c", text: "ê°œì¸ì˜ ì‹œê°„ì€ ì¡´ì¤‘ë°›ì•„ì•¼ í•œë‹¤ê³  ì£¼ì¥í•œë‹¤" }] },
            { id: 'q_m2_exp', part: "Part 3: ì¼ìƒì˜ í•© (ë¼ì´í”„ìŠ¤íƒ€ì¼)", for_gender: 'female', q_type: 'expectation', text: "íŒŒíŠ¸ë„ˆê°€ ê°œì¸ ì·¨ë¯¸ë¡œ ì£¼ë§ì„ ë³´ë‚¼ ë•Œ, ë‹¹ì‹ ì´ ì„œìš´í•¨ì„ ëŠë‚€ë‹¤ë©´ ì–´ë–»ê²Œ í–‰ë™í•´ì£¼ê¸¸ ë°”ë¼ë‚˜ìš”?", type: "select", options: [{ value: "a", text: "ì—°ì¸ê³¼ì˜ ì‹œê°„ì´ ë” ì¤‘ìš”í•˜ë¯€ë¡œ, ì·¨ë¯¸ë¥¼ ì¤„ì¸ë‹¤" }, { value: "b", text: "ì„œìš´í•¨ì„ í’€ì–´ì£¼ê³ , ì·¨ë¯¸ì˜ ì¤‘ìš”ì„±ì„ ì„¤ëª…í•˜ë©° íƒ€í˜‘ì ì„ ì°¾ëŠ”ë‹¤" }, { value: "c", text: "ê°œì¸ì˜ ì‹œê°„ì€ ì¡´ì¤‘ë°›ì•„ì•¼ í•œë‹¤ê³  ì£¼ì¥í•œë‹¤" }] },
            { id: 'q_f2_self', part: "Part 3: ì¼ìƒì˜ í•© (ë¼ì´í”„ìŠ¤íƒ€ì¼)", for_gender: 'female', q_type: 'self', text: "ë§ë²Œì´ë¥¼ í•  ê²½ìš°, ê°€ì‚¬ ë¶„ë‹´ì˜ ê°€ì¥ ì´ìƒì ì¸ ëª¨ìŠµì€?", type: "select", options: [{ value: "a", text: "ì‹œê°„ ì—¬ìœ ê°€ ìˆëŠ” ì‚¬ëŒì´ ë” ë§ì´ í•œë‹¤" }, { value: "b", text: "ê°ì ì˜í•˜ëŠ” ì¼ì„ ë¶„ë‹´í•´ì„œ ì²˜ë¦¬í•œë‹¤" }, { value: "c", text: "5:5ë¡œ ê³µí‰í•˜ê²Œ, ë˜ëŠ” ê·œì¹™ì„ ì •í•´ì„œ ë¶„ë‹´í•œë‹¤" }] },
            { id: 'q_f2_exp', part: "Part 3: ì¼ìƒì˜ í•© (ë¼ì´í”„ìŠ¤íƒ€ì¼)", for_gender: 'male', q_type: 'expectation', text: "ë§ë²Œì´ë¥¼ í•  ê²½ìš°, íŒŒíŠ¸ë„ˆê°€ ì–´ë–¤ ê°€ì‚¬ ë¶„ë‹´ ë°©ì‹ì„ ì„ í˜¸í•˜ê¸¸ ë°”ë¼ë‚˜ìš”?", type: "select", options: [{ value: "a", text: "ì‹œê°„ ì—¬ìœ ê°€ ìˆëŠ” ì‚¬ëŒì´ ë” ë§ì´ í•œë‹¤" }, { value: "b", text: "ê°ì ì˜í•˜ëŠ” ì¼ì„ ë¶„ë‹´í•´ì„œ ì²˜ë¦¬í•œë‹¤" }, { value: "c", text: "5:5ë¡œ ê³µí‰í•˜ê²Œ, ë˜ëŠ” ê·œì¹™ì„ ì •í•´ì„œ ë¶„ë‹´í•œë‹¤" }] },

            // Part 4: ê´€ê³„ì˜ ê¸°ìˆ 
            { id: 'q10_self', part: "Part 4: ê´€ê³„ì˜ ê¸°ìˆ  (ì†Œí†µ/ê´€ê³„)", q_type: 'self', text: "ì—°ì¸ì—ê²Œ 'ì‚¬ë‘ë°›ê³  ìˆë‹¤'ê³  ê°€ì¥ í¬ê²Œ ëŠë¼ëŠ” ìˆœê°„ì€?", type: "select", options: [{ value: "a", text: "ì‚¬ëŒë“¤ ì•ì—ì„œ ë‚˜ë¥¼ ìë‘ìŠ¤ëŸ½ê²Œ ì¹­ì°¬í•´ì¤„ ë•Œ (ì¸ì •í•˜ëŠ” ë§)" }, { value: "b", text: "í˜ë“¤ ë•Œ ë§ì—†ì´ ê½‰ ì•ˆì•„ì¤„ ë•Œ (ìŠ¤í‚¨ì‹­)" }, { value: "c", text: "ë‚˜ì™€ì˜ ì•½ì†ì„ ìµœìš°ì„ ìœ¼ë¡œ ìƒê°í•˜ê³  ì‹œê°„ì„ ë‚´ì–´ì¤„ ë•Œ (í•¨ê»˜í•˜ëŠ” ì‹œê°„)" }, { value: "d", text: "ë‚´ê°€ í˜ë“  ì¼ì„ ë¬µë¬µíˆ ëŒ€ì‹  ì²˜ë¦¬í•´ì¤„ ë•Œ (ë´‰ì‚¬)" }, { value: "e", text: "ë‚´ ì·¨í–¥ì„ ê¸°ì–µí•˜ê³  ê¹œì§ ì„ ë¬¼ì„ í•´ì¤„ ë•Œ (ì„ ë¬¼)" }] },
            { id: 'q_m3_self', part: "Part 4: ê´€ê³„ì˜ ê¸°ìˆ  (ì†Œí†µ/ê´€ê³„)", for_gender: 'male', q_type: 'self', text: "í˜ë“  ì¼ì´ ìˆì„ ë•Œ, ì—°ì¸ì—ê²Œ ì–´ëŠ ì •ë„ê¹Œì§€ ì†”ì§í•˜ê²Œ í„¸ì–´ë†“ë‚˜ìš”?", type: "select", options: [{ value: "a", text: "ì‚¬ì†Œí•œ ê²ƒê¹Œì§€ ëª¨ë‘ ê³µìœ í•˜ë©° ìœ„ë¡œë°›ê³  ì‹¶ë‹¤" }, { value: "b", text: "ê±±ì •ì‹œí‚¬ê¹Œ ë´, ì‹¬ê°í•œ ë¬¸ì œëŠ” í˜¼ì í•´ê²°í•˜ë ¤ í•œë‹¤" }, { value: "c", text: "ëŒ€ë¶€ë¶„ í˜¼ì í•´ê²°í•˜ì§€ë§Œ, ì •ë§ í˜ë“¤ ë• ê¸°ëŒ„ë‹¤" }] },
            { id: 'q_m3_exp', part: "Part 4: ê´€ê³„ì˜ ê¸°ìˆ  (ì†Œí†µ/ê´€ê³„)", for_gender: 'female', q_type: 'expectation', text: "íŒŒíŠ¸ë„ˆê°€ í˜ë“  ì¼ì„ ê²ªì„ ë•Œ, ë‹¹ì‹ ì—ê²Œ ì–´ë–»ê²Œ í•´ì£¼ê¸¸ ë°”ë¼ë‚˜ìš”?", type: "select", options: [{ value: "a", text: "ì‚¬ì†Œí•œ ê²ƒê¹Œì§€ ëª¨ë‘ ê³µìœ í•˜ë©° ìœ„ë¡œë°›ê³  ì‹¶ë‹¤" }, { value: "b", text: "ê±±ì •ì‹œí‚¬ê¹Œ ë´, ì‹¬ê°í•œ ë¬¸ì œëŠ” í˜¼ì í•´ê²°í•˜ë ¤ í•œë‹¤" }, { value: "c", text: "ëŒ€ë¶€ë¶„ í˜¼ì í•´ê²°í•˜ì§€ë§Œ, ì •ë§ í˜ë“¤ ë• ê¸°ëŒ„ë‹¤" }] },
            { id: 'q_f3_self', part: "Part 4: ê´€ê³„ì˜ ê¸°ìˆ  (ì†Œí†µ/ê´€ê³„)", for_gender: 'female', q_type: 'self', text: "ì—°ì¸ì—ê²Œ 'ë³´í˜¸ë°›ê³  ìˆë‹¤'ê³  ëŠë¼ê²Œ í•˜ëŠ” ê°€ì¥ ì¤‘ìš”í•œ í–‰ë™ì€ ë¬´ì—‡ì¸ê°€ìš”?", type: "select", options: [{ value: "a", text: "ë°¤ëŠ¦ê²Œ ê·€ê°€í•  ë•Œ ë°ë¦¬ëŸ¬ ì™€ì£¼ëŠ” ë“± ë¬¼ë¦¬ì ì¸ ë³´í˜¸" }, { value: "b", text: "ë‹¤ë¥¸ ì‚¬ëŒ ì•ì—ì„œ ë‚´ í¸ì„ ë“¤ì–´ì£¼ëŠ” ë“± ì‚¬íšŒì ì¸ ë³´í˜¸" }, { value: "c", text: "ë‚´ ê°ì •ì„ ì„¸ì‹¬í•˜ê²Œ ì‚´í”¼ê³  ê³µê°í•´ì£¼ëŠ” ì •ì„œì ì¸ ë³´í˜¸" }] },
            { id: 'q_f3_exp', part: "Part 4: ê´€ê³„ì˜ ê¸°ìˆ  (ì†Œí†µ/ê´€ê³„)", for_gender: 'male', q_type: 'expectation', text: "íŒŒíŠ¸ë„ˆê°€ 'ë³´í˜¸ë°›ê³  ìˆë‹¤'ê³  ëŠë¼ê²Œ í•˜ê¸° ìœ„í•´ ì–´ë–¤ í–‰ë™ì´ ê°€ì¥ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?", type: "select", options: [{ value: "a", text: "ë°¤ëŠ¦ê²Œ ê·€ê°€í•  ë•Œ ë°ë¦¬ëŸ¬ ì™€ì£¼ëŠ” ë“± ë¬¼ë¦¬ì ì¸ ë³´í˜¸" }, { value: "b", text: "ë‹¤ë¥¸ ì‚¬ëŒ ì•ì—ì„œ ë‚´ í¸ì„ ë“¤ì–´ì£¼ëŠ” ë“± ì‚¬íšŒì ì¸ ë³´í˜¸" }, { value: "c", text: "ë‚´ ê°ì •ì„ ì„¸ì‹¬í•˜ê²Œ ì‚´í”¼ê³  ê³µê°í•´ì£¼ëŠ” ì •ì„œì ì¸ ë³´í˜¸" }] },
        ];

        const partInfo = {
            "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)": { title: "ê°€ì¹˜ê´€ ê¶í•©", icon: "ğŸ§­", color: "green" },
            "Part 2: íƒ€ê³ ë‚œ ë‹¤ë¦„ (ì„±ê²©/ê¸°ì§ˆ)": { title: "ì„±ê²© ê¶í•©", icon: "ğŸ­", color: "purple" },
            "Part 3: ì¼ìƒì˜ í•© (ë¼ì´í”„ìŠ¤íƒ€ì¼)": { title: "ë¼ì´í”„ìŠ¤íƒ€ì¼ ê¶í•©", icon: "ğŸ¡", color: "yellow" },
            "Part 4: ê´€ê³„ì˜ ê¸°ìˆ  (ì†Œí†µ/ê´€ê³„)": { title: "ì†Œí†µ ë°©ì‹ ê¶í•©", icon: "â¤ï¸", color: "red" }
        };

        // --- UI Rendering Functions ---
        function renderQuestions() {
            const maleForm = document.getElementById('male-form');
            const femaleForm = document.getElementById('female-form');
            maleForm.innerHTML = '';
            femaleForm.innerHTML = '';
            let currentPartMale = "";
            let currentPartFemale = "";

            questions.forEach(q => {
                // Male Form
                if (!q.for_gender || q.for_gender === 'male') {
                    if (q.part !== currentPartMale) {
                        currentPartMale = q.part;
                        maleForm.innerHTML += `<h3 class="text-xl font-semibold text-blue-700 border-b-2 border-blue-200 pb-2 mb-4">${partInfo[currentPartMale].icon} ${currentPartMale}</h3>`;
                    }
                    maleForm.innerHTML += createQuestionHTML(q, 'male');
                }
                
                // Female Form
                if (!q.for_gender || q.for_gender === 'female') {
                     if (q.part !== currentPartFemale) {
                        currentPartFemale = q.part;
                        femaleForm.innerHTML += `<h3 class="text-xl font-semibold text-pink-700 border-b-2 border-pink-200 pb-2 mb-4">${partInfo[currentPartFemale].icon} ${currentPartFemale}</h3>`;
                    }
                    femaleForm.innerHTML += createQuestionHTML(q, 'female');
                }
            });
        }
        
        function createQuestionHTML(q, gender) {
            const isExpectation = q.q_type === 'expectation';
            const specificClass = isExpectation ? 'expectation-q' : 'self-q';
            const specificTag = isExpectation ? `<span class="text-xs font-bold text-white bg-teal-500 px-2 py-1 rounded-full ml-2">ìƒëŒ€ì—ê²Œ ê¸°ëŒ€</span>` : `<span class="text-xs font-bold text-white bg-indigo-500 px-2 py-1 rounded-full ml-2">ë‚˜ì˜ ìƒê°</span>`;

            return `
                <div class="question-card p-4 rounded-lg shadow ${specificClass}">
                    <label for="${q.id}-${gender}" class="block text-base font-medium text-gray-700 mb-3">${q.text} ${specificTag}</label>
                    ${q.type === 'select' ? createSelect(q, gender) : createRange(q, gender)}
                </div>`;
        }


        function createSelect(q, gender) {
            const optionsHTML = q.options.map(opt => `<option value="${opt.value}">${opt.text}</option>`).join('');
            return `<select id="${q.id}-${gender}" name="${q.id}" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white">
                        ${optionsHTML}
                    </select>`;
        }

        // --- Matching Algorithm Logic (v9: Integrated) ---
        const matchups = [
            // Type 1: ë‚˜ì˜ ìƒê° vs ìƒëŒ€ì˜ ìƒê° (Self vs Self)
            { type: 'SvsS', male_q: 'q_child_plan_self', female_q: 'q_child_plan_self', part: "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)" },
            { type: 'SvsS', male_q: 'q7_self', female_q: 'q7_self', part: "Part 3: ì¼ìƒì˜ í•© (ë¼ì´í”„ìŠ¤íƒ€ì¼)" },
            { type: 'SvsS', male_q: 'q_dessert_self', female_q: 'q_dessert_self', part: "Part 3: ì¼ìƒì˜ í•© (ë¼ì´í”„ìŠ¤íƒ€ì¼)" },
            { type: 'SvsS', male_q: 'q10_self', female_q: 'q10_self', part: "Part 4: ê´€ê³„ì˜ ê¸°ìˆ  (ì†Œí†µ/ê´€ê³„)" },

            // Type 2: ë‚˜ì˜ ìƒê° vs ìƒëŒ€ì˜ ê¸°ëŒ€ (Self vs Expectation)
            { type: 'SvsE', self: 'q1_self', exp: 'q1_exp', self_gender: 'male', exp_gender: 'female', part: "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)" },
            { type: 'SvsE', self: 'q1_self', exp: 'q1_exp', self_gender: 'female', exp_gender: 'male', part: "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)" },
            { type: 'SvsE', self: 'q_m1_self', exp: 'q_m1_exp', self_gender: 'male', exp_gender: 'female', part: "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)" },
            { type: 'SvsE', self: 'q_f1_self', exp: 'q_f1_exp', self_gender: 'female', exp_gender: 'male', part: "Part 1: ì‚¶ì˜ ë‚˜ì¹¨ë°˜ (ê°€ì¹˜ê´€)" },
            { type: 'SvsE', self: 'q5_self', exp: 'q5_exp', self_gender: 'male', exp_gender: 'female', part: "Part 2: íƒ€ê³ ë‚œ ë‹¤ë¦„ (ì„±ê²©/ê¸°ì§ˆ)" },
            { type: 'SvsE', self: 'q5_self', exp: 'q5_exp', self_gender: 'female', exp_gender: 'male', part: "Part 2: íƒ€ê³ ë‚œ ë‹¤ë¦„ (ì„±ê²©/ê¸°ì§ˆ)" },
            { type: 'SvsE', self: 'q_m2_self', exp: 'q_m2_exp', self_gender: 'male', exp_gender: 'female', part: "Part 3: ì¼ìƒì˜ í•© (ë¼ì´í”„ìŠ¤íƒ€ì¼)" },
            { type: 'SvsE', self: 'q_f2_self', exp: 'q_f2_exp', self_gender: 'female', exp_gender: 'male', part: "Part 3: ì¼ìƒì˜ í•© (ë¼ì´í”„ìŠ¤íƒ€ì¼)" },
            { type: 'SvsE', self: 'q_m3_self', exp: 'q_m3_exp', self_gender: 'male', exp_gender: 'female', part: "Part 4: ê´€ê³„ì˜ ê¸°ìˆ  (ì†Œí†µ/ê´€ê³„)" },
            { type: 'SvsE', self: 'q_f3_self', exp: 'q_f3_exp', self_gender: 'female', exp_gender: 'male', part: "Part 4: ê´€ê³„ì˜ ê¸°ìˆ  (ì†Œí†µ/ê´€ê³„)" },
        ];

        function calculateResults() {
            const maleAnswers = getAnswers('male');
            const femaleAnswers = getAnswers('female');
            
            const results = {};
            let allScores = [];

            for (const part in partInfo) {
                const partMatchups = matchups.filter(m => m.part === part);
                if (partMatchups.length === 0) continue;

                const partScores = partMatchups.map(m => {
                    let answer1, answer2;
                    if (m.type === 'SvsS') {
                        answer1 = maleAnswers[m.male_q];
                        answer2 = femaleAnswers[m.female_q];
                    } else { // SvsE
                        answer1 = (m.self_gender === 'male') ? maleAnswers[m.self] : femaleAnswers[m.self];
                        answer2 = (m.exp_gender === 'male') ? maleAnswers[m.exp] : femaleAnswers[m.exp];
                    }
                    const question = questions.find(q => q.id === (m.male_q || m.self));
                    return calculateScore(question, answer1, answer2);
                });
                
                const averageScore = partScores.reduce((a, b) => a + b, 0) / partScores.length;
                results[part] = {
                    score: Math.round(averageScore),
                    comment: getComment(part, Math.round(averageScore))
                };
                allScores.push(...partScores);
            }
            
            const overallAverage = allScores.reduce((a, b) => a + b, 0) / allScores.length;
            results.overall = {
                score: Math.round(overallAverage),
                comment: getOverallComment(Math.round(overallAverage))
            };

            displayResults(results, maleAnswers, femaleAnswers);
        }

        function getAnswers(gender) {
            const form = document.getElementById(`${gender}-form`);
            const formData = new FormData(form);
            const answers = {};
            for (let [key, value] of formData.entries()) {
                answers[key] = value;
            }
            return answers;
        }

        function calculateScore(question, answer1, answer2) {
            if (!question || !answer1 || !answer2) return 50; // ê¸°ë³¸ ì ìˆ˜
            if (question.id === 'q_child_plan_self') {
                const scoreMap = { 'a': 1, 'b': 2, 'c': 4, 'd': 3 };
                const diff = Math.abs(scoreMap[answer1] - scoreMap[answer2]);
                return Math.max(0, 100 - diff * 33);
            }
            if (question.type === 'select') {
                return answer1 === answer2 ? 100 : 0;
            }
            return 50;
        }

        // --- Result Generation and Display ---
        function getComment(part, score) {
            if (score >= 80) return "ì•„ì£¼ ì˜ ë§ì•„ìš”! ë‘ ë¶„ì€ ì„œë¡œë¥¼ ì˜ ì´í•´í•˜ê³  ê¸°ëŒ€ë¥¼ ì±„ì›Œì£¼ëŠ” ë©‹ì§„ íŒŒíŠ¸ë„ˆê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
            if (score >= 60) return "ì˜ ë§ëŠ” í¸ì´ì—ìš”. ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì„œë¡œë¥¼ ë§Œì¡±ì‹œí‚¤ì§€ë§Œ, ì•½ê°„ì˜ ìƒê°ê³¼ ê¸°ëŒ€ì¹˜ ì°¨ì´ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.";
            if (score >= 40) return "ìƒê°ì´ë‚˜ ê¸°ëŒ€ì¹˜ê°€ ë‹¤ë¥¸ ë¶€ë¶„ì´ ìˆë„¤ìš”. ì´ ì°¨ì´ì ì— ëŒ€í•´ ì´ì•¼ê¸° ë‚˜ëˆ„ë©° ì„œë¡œë¥¼ ì´í•´í•˜ëŠ” ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.";
            return "ìƒë‹¹í•œ ìƒê°ê³¼ ê¸°ëŒ€ì¹˜ ì°¨ì´ê°€ ë°œê²¬ë˜ì—ˆì–´ìš”. ì´ ë¶€ë¶„ì€ ê´€ê³„ì—ì„œ ì˜¤í•´ì˜ ì†Œì§€ê°€ ë  ìˆ˜ ìˆìœ¼ë‹ˆ, ê¹Šì€ ëŒ€í™”ê°€ ê¼­ í•„ìš”í•´ ë³´ì…ë‹ˆë‹¤.";
        }
        
        function getOverallComment(score) {
            if (score >= 85) return "í™˜ìƒì˜ ì»¤í”Œ! ì„œë¡œì˜ ìƒê°ê³¼ ê¸°ëŒ€ë¥¼ ì™„ë²½í•˜ê²Œ ì±„ì›Œì£¼ëŠ”, ì²œìƒì—°ë¶„ì…ë‹ˆë‹¤!";
            if (score >= 70) return "ë©‹ì§„ ì¡°í•©ì´ì—ìš”! ì„œë¡œì˜ ë§ˆìŒì„ ì˜ ì•Œì•„ì£¼ê³  ë§ì¶°ì£¼ë©° í•¨ê»˜ ì„±ì¥í•  ìˆ˜ ìˆëŠ” ê´€ê³„ì…ë‹ˆë‹¤.";
            if (score >= 50) return "ì•Œì•„ê°€ëŠ” ì¬ë¯¸ê°€ ìˆê² ì–´ìš”! ì„œë¡œì˜ ìƒê°ê³¼ ê¸°ëŒ€ì¹˜ë¥¼ ì•Œì•„ê°€ë©° ë§ì¶°ê°€ëŠ” ê³¼ì •ì´ ì¦ê±°ìš¸ ê±°ì˜ˆìš”.";
            return "ë„ì „ì ì¸ ê´€ê³„ê°€ ë  ìˆ˜ ìˆì–´ìš”! ì„œë¡œì˜ ìƒê°ê³¼ ê¸°ëŒ€ê°€ ë‹¤ë¥¸ ë¶€ë¶„ì´ ë§ì§€ë§Œ, ëŒ€í™”ë¥¼ í†µí•´ ì¶©ë¶„íˆ ê·¹ë³µí•˜ê³  ë” ê¹Šì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
        }

        function displayResults(results, maleAnswers, femaleAnswers) {
            document.getElementById('overall-score').textContent = `${results.overall.score}ì `;
            document.getElementById('overall-comment').textContent = results.overall.comment;

            const container = document.getElementById('detailed-results-container');
            container.innerHTML = '';
            for (const part in partInfo) {
                if(results[part]){
                    const info = partInfo[part];
                    const result = results[part];
                    container.innerHTML += createResultCard(info, result);
                }
            }
            
            for (const part in partInfo) {
                if(results[part]){
                    const info = partInfo[part];
                    const result = results[part];
                    const progressBar = document.querySelector(`#bar-${info.color}`);
                    setTimeout(() => {
                        if(progressBar) progressBar.style.width = `${result.score}%`;
                    }, 100);
                }
            }
            
            document.getElementById('ice-breaking-questions').innerHTML = generateIceBreakers(maleAnswers, femaleAnswers);

            document.getElementById('result-modal').classList.remove('hidden');
            document.getElementById('result-modal').classList.add('flex');
            setTimeout(() => {
                document.getElementById('result-content').classList.remove('scale-95');
                document.getElementById('result-content').classList.add('scale-100');
            }, 50);
        }
        
        function createResultCard(info, result) {
            const colorClasses = {
                green: { bg: 'bg-green-100', border: 'border-green-300', bar: 'bg-green-500', text: 'text-green-800' },
                purple: { bg: 'bg-purple-100', border: 'border-purple-300', bar: 'bg-purple-500', text: 'text-purple-800' },
                yellow: { bg: 'bg-yellow-100', border: 'border-yellow-300', bar: 'bg-yellow-500', text: 'text-yellow-800' },
                red: { bg: 'bg-red-100', border: 'border-red-300', bar: 'bg-red-500', text: 'text-red-800' },
            };
            const c = colorClasses[info.color];

            return `
                <div class="${c.bg} ${c.border} border-l-4 p-4 rounded-lg">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="text-lg font-bold ${c.text}">${info.icon} ${info.title}</h3>
                        <span class="font-bold text-xl ${c.text}">${result.score}ì </span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="bar-${info.color}" class="result-bar ${c.bar} h-2.5 rounded-full" style="width: 0%;"></div>
                    </div>
                    <p class="mt-2 text-sm ${c.text}">${result.comment}</p>
                </div>
            `;
        }
        
        // --- Icebreaker Generation Logic (v9: Integrated) ---
        function generateIceBreakers(maleAnswers, femaleAnswers) {
            let suggestions = [];

            const getAnswerText = (qId, answerValue) => {
                const question = questions.find(q => q.id === qId);
                if (!question || !answerValue) return '"[ì‘ë‹µ ì—†ìŒ]"';
                const option = question.options.find(o => o.value === answerValue);
                return option ? `"${option.text}"` : answerValue;
            };

            // 1. ë‚¨ì„±ì˜ ì‹¤ì œ ì„±í–¥ vs ì—¬ì„±ì˜ ê¸°ëŒ€
            const male_self_m1 = getAnswerText('q_m1_self', maleAnswers.q_m1_self);
            const female_exp_m1 = getAnswerText('q_m1_exp', femaleAnswers.q_m1_exp);
            if (maleAnswers.q_m1_self === femaleAnswers.q_m1_exp) {
                suggestions.push({
                    title: "ğŸ‘©â€ğŸ¦°â¤ï¸ğŸ‘¨â€ğŸ¦± ê¸°ëŒ€ì™€ í˜„ì‹¤ì˜ ì¼ì¹˜!",
                    text: `'íŒŒíŠ¸ë„ˆì˜ ì†Œë“/ì§ì—…ì— ëŒ€í•œ ë¶ˆì•ˆê°'ì— ëŒ€í•´, ë‚¨ì„±ë¶„ì€ ì‹¤ì œë¡œ ${male_self_m1}(ì´)ë¼ê³  í–‰ë™í•˜ê³ , ì—¬ì„±ë¶„ì€ íŒŒíŠ¸ë„ˆê°€ ê·¸ë ‡ê²Œ í•´ì£¼ê¸¸ ë°”ëì–´ìš”. ì„œë¡œì˜ ê¸°ëŒ€ë¥¼ ì™„ë²½í•˜ê²Œ ì±„ì›Œì£¼ëŠ”, ì •ë§ ì˜ ë§ëŠ” ì»¤í”Œì´ë„¤ìš”!`
                });
            } else {
                suggestions.push({
                    title: "ğŸ‘©â€ğŸ¦°â†”ï¸ğŸ‘¨â€ğŸ¦± ì„œë¡œì˜ ë§ˆìŒ ì•Œì•„ë³´ê¸°",
                    text: `'íŒŒíŠ¸ë„ˆì˜ ì†Œë“/ì§ì—…ì— ëŒ€í•œ ë¶ˆì•ˆê°'ì— ëŒ€í•´, ë‚¨ì„±ë¶„ì€ ${male_self_m1}(ì´)ë¼ê³  ë‹µí–ˆì§€ë§Œ, ì—¬ì„±ë¶„ì€ ${female_exp_m1}(ì´)ë¼ê³  í•´ì£¼ê¸¸ ë°”ëì–´ìš”. ì´ ìƒê°ì˜ ì°¨ì´ì— ëŒ€í•´ ì´ì•¼ê¸° ë‚˜ëˆ ë³´ë©´ ì„œë¡œë¥¼ ë” ê¹Šì´ ì´í•´í•  ìˆ˜ ìˆì„ ê±°ì˜ˆìš”.`
                });
            }

            // 2. ì—¬ì„±ì˜ ì‹¤ì œ ì„±í–¥ vs ë‚¨ì„±ì˜ ê¸°ëŒ€
            const female_self_f1 = getAnswerText('q_f1_self', femaleAnswers.q_f1_self);
            const male_exp_f1 = getAnswerText('q_f1_exp', maleAnswers.q_f1_exp);
            if (femaleAnswers.q_f1_self === maleAnswers.q_f1_exp) {
                suggestions.push({
                    title: "ğŸ‘¨â€ğŸ¦±â¤ï¸ğŸ‘©â€ğŸ¦° ì™„ë²½í•œ í•˜ëª¨ë‹ˆ!",
                    text: `'ì»¤ë¦¬ì–´ ì¤‘ë‹¨ ê°€ëŠ¥ì„±'ì— ëŒ€í•´, ì—¬ì„±ë¶„ì€ ì‹¤ì œë¡œ ${female_self_f1}(ì´)ë¼ê³  ìƒê°í•˜ê³ , ë‚¨ì„±ë¶„ì€ íŒŒíŠ¸ë„ˆê°€ ê·¸ë ‡ê²Œ ìƒê°í•´ì£¼ê¸¸ ë°”ëì–´ìš”. ë¯¸ë˜ë¥¼ ê·¸ë¦¬ëŠ” ê°€ì¹˜ê´€ì´ ì¼ì¹˜í•˜ì—¬ ì•ˆì •ì ì¸ ê´€ê³„ë¥¼ ë§Œë“¤ì–´ê°ˆ ìˆ˜ ìˆê² ì–´ìš”.`
                });
            } else {
                suggestions.push({
                    title: "ğŸ‘¨â€ğŸ¦±â†”ï¸ğŸ‘©â€ğŸ¦° ì¡´ì¤‘ê³¼ ì´í•´ì˜ ì‹œê°„",
                    text: `'ì»¤ë¦¬ì–´ ì¤‘ë‹¨ ê°€ëŠ¥ì„±'ì— ëŒ€í•´, ì—¬ì„±ë¶„ì€ ${female_self_f1}(ì´)ë¼ê³  ë‹µí–ˆì§€ë§Œ, ë‚¨ì„±ë¶„ì€ ${male_exp_f1}(ì´)ë¼ê³  ìƒê°í•´ì£¼ê¸¸ ë°”ëì–´ìš”. ê°ìì˜ ì»¤ë¦¬ì–´ì™€ ì‚¶ì˜ ëª©í‘œì— ëŒ€í•´ ì§„ì†”í•œ ëŒ€í™”ë¥¼ ë‚˜ëˆ„ë©° ì„œë¡œë¥¼ ì‘ì›í•´ì£¼ì„¸ìš”.`
                });
            }

            // 3. ìë…€ ê³„íš (ë‚˜ì˜ ìƒê° vs ë‚˜ì˜ ìƒê°)
            const male_child_plan = getAnswerText('q_child_plan_self', maleAnswers.q_child_plan_self);
            const female_child_plan = getAnswerText('q_child_plan_self', femaleAnswers.q_child_plan_self);
            if(maleAnswers.q_child_plan_self !== femaleAnswers.q_child_plan_self) {
                 suggestions.push({
                    title: "ğŸ§­ ë¯¸ë˜ë¥¼ í•¨ê»˜ ê·¸ë¦¬ë‹¤",
                    text: `ìë…€ ê³„íšì— ëŒ€í•´ ë‚¨ì„±ë¶„ì€ ${male_child_plan}, ì—¬ì„±ë¶„ì€ ${female_child_plan}(ì´)ë¼ê³  ë‹µí–ˆì–´ìš”. ì´ ì£¼ì œëŠ” ê´€ê³„ì—ì„œ ë§¤ìš° ì¤‘ìš”í•˜ë¯€ë¡œ, ë‘ ë¶„ì´ ìƒê°í•˜ëŠ” ì´ìƒì ì¸ ê°€ì¡±ì˜ ëª¨ìŠµê³¼ ë¯¸ë˜ì— ëŒ€í•´ ì†”ì§í•œ ëŒ€í™”ë¥¼ ë‚˜ëˆ ë³´ëŠ” ê²ƒì´ ì¤‘ìš”í•´ìš”.`
                });
            }


            return suggestions.map(s => `
                <div class="bg-gray-100 p-4 rounded-lg">
                    <h4 class="font-bold text-gray-800 text-lg mb-2">${s.title}</h4>
                    <p class="text-gray-600 text-base">${s.text}</p>
                </div>
            `).join('');
        }

        // --- Event Listeners ---
        document.getElementById('view-result-btn').addEventListener('click', calculateResults);
        document.getElementById('close-modal-btn').addEventListener('click', () => {
            document.getElementById('result-content').classList.add('scale-95');
            document.getElementById('result-content').classList.remove('scale-100');
            setTimeout(() => {
                document.getElementById('result-modal').classList.add('hidden');
                document.getElementById('result-modal').classList.remove('flex');
            }, 300);
        });

        // Initial Render
        window.onload = renderQuestions;
    </script>
</body>
</html>
